-- Violence District Mobile Script
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local Lighting = game:GetService("Lighting")
local Workspace = game:GetService("Workspace")
local CoreGui = game:GetService("CoreGui")
local LocalPlayer = Players.LocalPlayer

local _F = {}

-- Мобильные настройки
_F.MOBILE_SETTINGS = {
    BUTTON_HEIGHT = 35,
    SLIDER_HEIGHT = 55,
    FONT_SIZE = 12,
    MENU_WIDTH = 320,
    MENU_HEIGHT = 450
}

_F._cache = {}
_F._connections = {}

-- Создание GUI
_F.ScreenGui = Instance.new("ScreenGui")
_F.ScreenGui.Name = "VDMobileMenu"
_F.ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
_F.ScreenGui.ResetOnSpawn = false
_F.ScreenGui.Parent = CoreGui

-- Основной фрейм
_F.MainFrame = Instance.new("Frame")
_F.MainFrame.Name = "MainFrame"
_F.MainFrame.Size = UDim2.new(0, _F.MOBILE_SETTINGS.MENU_WIDTH, 0, _F.MOBILE_SETTINGS.MENU_HEIGHT)
_F.MainFrame.Position = UDim2.new(0.5, -_F.MOBILE_SETTINGS.MENU_WIDTH/2, 0.5, -_F.MOBILE_SETTINGS.MENU_HEIGHT/2)
_F.MainFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 25)
_F.MainFrame.BorderSizePixel = 0
_F.MainFrame.ClipsDescendants = true
_F.MainFrame.Parent = _F.ScreenGui

-- Углы
_F.UICorner = Instance.new("UICorner")
_F.UICorner.CornerRadius = UDim.new(0, 8)
_F.UICorner.Parent = _F.MainFrame

-- Обводка
_F.UIStroke = Instance.new("UIStroke")
_F.UIStroke.Color = Color3.fromRGB(60, 60, 70)
_F.UIStroke.Thickness = 2
_F.UIStroke.Parent = _F.MainFrame

-- Заголовок
_F.TitleFrame = Instance.new("Frame")
_F.TitleFrame.Name = "TitleFrame"
_F.TitleFrame.Size = UDim2.new(1, 0, 0, 35)
_F.TitleFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
_F.TitleFrame.BorderSizePixel = 0
_F.TitleFrame.Parent = _F.MainFrame

_F.TitleCorner = Instance.new("UICorner")
_F.TitleCorner.CornerRadius = UDim.new(0, 8)
_F.TitleCorner.Parent = _F.TitleFrame

_F.TitleLabel = Instance.new("TextLabel")
_F.TitleLabel.Name = "TitleLabel"
_F.TitleLabel.Size = UDim2.new(1, 0, 1, 0)
_F.TitleLabel.BackgroundTransparency = 1
_F.TitleLabel.Text = "VD MOBILE"
_F.TitleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
_F.TitleLabel.TextSize = 14
_F.TitleLabel.Font = Enum.Font.GothamBold
_F.TitleLabel.Parent = _F.TitleFrame

-- Вкладки
_F.TabButtonsFrame = Instance.new("Frame")
_F.TabButtonsFrame.Name = "TabButtonsFrame"
_F.TabButtonsFrame.Size = UDim2.new(1, -20, 0, 30)
_F.TabButtonsFrame.Position = UDim2.new(0, 10, 0, 40)
_F.TabButtonsFrame.BackgroundTransparency = 1
_F.TabButtonsFrame.Parent = _F.MainFrame

_F.TabButtonsLayout = Instance.new("UIListLayout")
_F.TabButtonsLayout.FillDirection = Enum.FillDirection.Horizontal
_F.TabButtonsLayout.Padding = UDim.new(0, 5)
_F.TabButtonsLayout.Parent = _F.TabButtonsFrame

-- Контент
_F.ContentFrame = Instance.new("Frame")
_F.ContentFrame.Name = "ContentFrame"
_F.ContentFrame.Size = UDim2.new(1, -20, 1, -80)
_F.ContentFrame.Position = UDim2.new(0, 10, 0, 75)
_F.ContentFrame.BackgroundTransparency = 1
_F.ContentFrame.Parent = _F.MainFrame

-- Фреймы контента
_F.ESPSettingsFrame = Instance.new("ScrollingFrame")
_F.ESPSettingsFrame.Name = "ESPSettingsFrame"
_F.ESPSettingsFrame.Size = UDim2.new(1, 0, 1, 0)
_F.ESPSettingsFrame.BackgroundTransparency = 1
_F.ESPSettingsFrame.ScrollBarThickness = 4
_F.ESPSettingsFrame.ScrollBarImageColor3 = Color3.fromRGB(80, 80, 90)
_F.ESPSettingsFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
_F.ESPSettingsFrame.AutomaticCanvasSize = Enum.AutomaticSize.Y
_F.ESPSettingsFrame.Visible = true
_F.ESPSettingsFrame.Parent = _F.ContentFrame

_F.GameFeaturesFrame = Instance.new("ScrollingFrame")
_F.GameFeaturesFrame.Name = "GameFeaturesFrame"
_F.GameFeaturesFrame.Size = UDim2.new(1, 0, 1, 0)
_F.GameFeaturesFrame.BackgroundTransparency = 1
_F.GameFeaturesFrame.ScrollBarThickness = 4
_F.GameFeaturesFrame.ScrollBarImageColor3 = Color3.fromRGB(80, 80, 90)
_F.GameFeaturesFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
_F.GameFeaturesFrame.AutomaticCanvasSize = Enum.AutomaticSize.Y
_F.GameFeaturesFrame.Visible = false
_F.GameFeaturesFrame.Parent = _F.ContentFrame

_F.VisualSettingsFrame = Instance.new("ScrollingFrame")
_F.VisualSettingsFrame.Name = "VisualSettingsFrame"
_F.VisualSettingsFrame.Size = UDim2.new(1, 0, 1, 0)
_F.VisualSettingsFrame.BackgroundTransparency = 1
_F.VisualSettingsFrame.ScrollBarThickness = 4
_F.VisualSettingsFrame.ScrollBarImageColor3 = Color3.fromRGB(80, 80, 90)
_F.VisualSettingsFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
_F.VisualSettingsFrame.AutomaticCanvasSize = Enum.AutomaticSize.Y
_F.VisualSettingsFrame.Visible = false
_F.VisualSettingsFrame.Parent = _F.ContentFrame

-- Layout
_F.ESPLayout = Instance.new("UIListLayout")
_F.ESPLayout.Padding = UDim.new(0, 8)
_F.ESPLayout.Parent = _F.ESPSettingsFrame

_F.FeaturesLayout = Instance.new("UIListLayout")
_F.FeaturesLayout.Padding = UDim.new(0, 8)
_F.FeaturesLayout.Parent = _F.GameFeaturesFrame

_F.VisualLayout = Instance.new("UIListLayout")
_F.VisualLayout.Padding = UDim.new(0, 8)
_F.VisualLayout.Parent = _F.VisualSettingsFrame

-- Переменные состояния
_F.MenuOpen = true
_F.ESPEnabled = false
_F.walkSpeedActive = false
_F.walkSpeed = 16
_F.JumpPowerEnabled = false
_F.JumpPowerValue = 50
_F.FlyEnabled = false
_F.FlySpeedValue = 50
_F.NoclipEnabled = false
_F.GodModeEnabled = false
_F.NoFogEnabled = false
_F.TimeEnabled = false
_F.TimeValue = 12

-- ESP переменные
_F.ESPFolders = {}
_F.ESPConnections = {}

-- Функция создания кнопки вкладки
_F.CreateTabButton = function(name, targetFrame)
    local TabButton = Instance.new("TextButton")
    TabButton.Name = name .. "Tab"
    TabButton.Size = UDim2.new(0.33, -4, 1, 0)
    TabButton.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
    TabButton.BorderSizePixel = 0
    TabButton.Text = name
    TabButton.TextColor3 = Color3.fromRGB(200, 200, 200)
    TabButton.TextSize = 11
    TabButton.Font = Enum.Font.GothamBold
    TabButton.Parent = _F.TabButtonsFrame
    
    local TabCorner = Instance.new("UICorner")
    TabCorner.CornerRadius = UDim.new(0, 6)
    TabCorner.Parent = TabButton
    
    TabButton.MouseButton1Click:Connect(function()
        _F.ESPSettingsFrame.Visible = false
        _F.GameFeaturesFrame.Visible = false
        _F.VisualSettingsFrame.Visible = false
        
        targetFrame.Visible = true
        
        for _, child in ipairs(_F.TabButtonsFrame:GetChildren()) do
            if child:IsA("TextButton") then
                child.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
                child.TextColor3 = Color3.fromRGB(200, 200, 200)
            end
        end
        
        TabButton.BackgroundColor3 = Color3.fromRGB(0, 100, 255)
        TabButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    end)
    
    return TabButton
end

-- Создание вкладок
_F.ESPTab = _F.CreateTabButton("ESP", _F.ESPSettingsFrame)
_F.FeaturesTab = _F.CreateTabButton("FEATURES", _F.GameFeaturesFrame)
_F.VisualTab = _F.CreateTabButton("VISUAL", _F.VisualSettingsFrame)

-- Активируем первую вкладку
_F.ESPTab.BackgroundColor3 = Color3.fromRGB(0, 100, 255)
_F.ESPTab.TextColor3 = Color3.fromRGB(255, 255, 255)

-- Функция создания переключателя
_F.CreateToggle = function(name, defaultValue, callback, parentFrame)
    local ToggleFrame = Instance.new("Frame")
    ToggleFrame.Name = name .. "Toggle"
    ToggleFrame.Size = UDim2.new(1, 0, 0, _F.MOBILE_SETTINGS.BUTTON_HEIGHT)
    ToggleFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
    ToggleFrame.BorderSizePixel = 0
    ToggleFrame.Parent = parentFrame
    
    local ToggleCorner = Instance.new("UICorner")
    ToggleCorner.CornerRadius = UDim.new(0, 6)
    ToggleCorner.Parent = ToggleFrame
    
    local ToggleLabel = Instance.new("TextLabel")
    ToggleLabel.Name = "ToggleLabel"
    ToggleLabel.Size = UDim2.new(0.7, 0, 1, 0)
    ToggleLabel.Position = UDim2.new(0, 10, 0, 0)
    ToggleLabel.BackgroundTransparency = 1
    ToggleLabel.Text = name
    ToggleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    ToggleLabel.TextSize = _F.MOBILE_SETTINGS.FONT_SIZE
    ToggleLabel.Font = Enum.Font.Gotham
    ToggleLabel.TextXAlignment = Enum.TextXAlignment.Left
    ToggleLabel.Parent = ToggleFrame
    
    local ToggleButton = Instance.new("TextButton")
    ToggleButton.Name = "ToggleButton"
    ToggleButton.Size = UDim2.new(0, 45, 0, 22)
    ToggleButton.Position = UDim2.new(1, -50, 0.5, -11)
    ToggleButton.BackgroundColor3 = defaultValue and Color3.fromRGB(0, 200, 0) or Color3.fromRGB(80, 80, 90)
    ToggleButton.BorderSizePixel = 0
    ToggleButton.Text = ""
    ToggleButton.Parent = ToggleFrame
    
    local ToggleCorner2 = Instance.new("UICorner")
    ToggleCorner2.CornerRadius = UDim.new(0, 11)
    ToggleCorner2.Parent = ToggleButton
    
    local ToggleDot = Instance.new("Frame")
    ToggleDot.Name = "ToggleDot"
    ToggleDot.Size = UDim2.new(0, 18, 0, 18)
    ToggleDot.Position = UDim2.new(0, defaultValue and 25 or 2, 0, 2)
    ToggleDot.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    ToggleDot.BorderSizePixel = 0
    ToggleDot.Parent = ToggleButton
    
    local ToggleCorner3 = Instance.new("UICorner")
    ToggleCorner3.CornerRadius = UDim.new(0, 9)
    ToggleCorner3.Parent = ToggleDot
    
    ToggleButton.MouseButton1Click:Connect(function()
        defaultValue = not defaultValue
        ToggleButton.BackgroundColor3 = defaultValue and Color3.fromRGB(0, 200, 0) or Color3.fromRGB(80, 80, 90)
        
        local tweenInfo = TweenInfo.new(0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
        local tween = TweenService:Create(ToggleDot, tweenInfo, {
            Position = UDim2.new(0, defaultValue and 25 or 2, 0, 2)
        })
        tween:Play()
        
        callback(defaultValue)
    end)
    
    return ToggleFrame
end

-- Функция создания слайдера
_F.CreateSlider = function(name, minValue, maxValue, defaultValue, callback, parentFrame)
    local SliderFrame = Instance.new("Frame")
    SliderFrame.Name = name .. "Slider"
    SliderFrame.Size = UDim2.new(1, 0, 0, _F.MOBILE_SETTINGS.SLIDER_HEIGHT)
    SliderFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
    SliderFrame.BorderSizePixel = 0
    SliderFrame.Parent = parentFrame
    
    local SliderCorner = Instance.new("UICorner")
    SliderCorner.CornerRadius = UDim.new(0, 6)
    SliderCorner.Parent = SliderFrame
    
    local SliderLabel = Instance.new("TextLabel")
    SliderLabel.Name = "SliderLabel"
    SliderLabel.Size = UDim2.new(1, -20, 0, 20)
    SliderLabel.Position = UDim2.new(0, 10, 0, 5)
    SliderLabel.BackgroundTransparency = 1
    SliderLabel.Text = name .. ": " .. defaultValue
    SliderLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    SliderLabel.TextSize = _F.MOBILE_SETTINGS.FONT_SIZE
    SliderLabel.Font = Enum.Font.Gotham
    SliderLabel.TextXAlignment = Enum.TextXAlignment.Left
    SliderLabel.Parent = SliderFrame
    
    local SliderTrack = Instance.new("Frame")
    SliderTrack.Name = "SliderTrack"
    SliderTrack.Size = UDim2.new(1, -20, 0, 6)
    SliderTrack.Position = UDim2.new(0, 10, 0, 30)
    SliderTrack.BackgroundColor3 = Color3.fromRGB(60, 60, 70)
    SliderTrack.BorderSizePixel = 0
    SliderTrack.Parent = SliderFrame
    
    local SliderTrackCorner = Instance.new("UICorner")
    SliderTrackCorner.CornerRadius = UDim.new(0, 3)
    SliderTrackCorner.Parent = SliderTrack
    
    local SliderFill = Instance.new("Frame")
    SliderFill.Name = "SliderFill"
    SliderFill.Size = UDim2.new((defaultValue - minValue) / (maxValue - minValue), 0, 1, 0)
    SliderFill.BackgroundColor3 = Color3.fromRGB(0, 150, 255)
    SliderFill.BorderSizePixel = 0
    SliderFill.Parent = SliderTrack
    
    local SliderFillCorner = Instance.new("UICorner")
    SliderFillCorner.CornerRadius = UDim.new(0, 3)
    SliderFillCorner.Parent = SliderFill
    
    local SliderButton = Instance.new("TextButton")
    SliderButton.Name = "SliderButton"
    SliderButton.Size = UDim2.new(0, 18, 0, 18)
    SliderButton.Position = UDim2.new((defaultValue - minValue) / (maxValue - minValue), -9, 0.5, -9)
    SliderButton.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    SliderButton.BorderSizePixel = 0
    SliderButton.Text = ""
    SliderButton.ZIndex = 2
    SliderButton.Parent = SliderTrack
    
    local SliderButtonCorner = Instance.new("UICorner")
    SliderButtonCorner.CornerRadius = UDim.new(0, 9)
    SliderButtonCorner.Parent = SliderButton
    
    local dragging = false
    
    local function updateSlider(input)
        if not dragging then return end
        
        local relativeX = math.clamp((input.Position.X - SliderTrack.AbsolutePosition.X) / SliderTrack.AbsoluteSize.X, 0, 1)
        local value = math.floor(minValue + (maxValue - minValue) * relativeX)
        
        SliderFill.Size = UDim2.new(relativeX, 0, 1, 0)
        SliderButton.Position = UDim2.new(relativeX, -9, 0.5, -9)
        SliderLabel.Text = name .. ": " .. value
        
        callback(value)
    end
    
    SliderButton.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.Touch or input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
        end
    end)
    
    SliderTrack.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.Touch or input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            updateSlider(input)
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if dragging and (input.UserInputType == Enum.UserInputType.Touch or input.UserInputType == Enum.UserInputType.MouseMovement) then
            updateSlider(input)
        end
    end)
    
    UserInputService.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.Touch or input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = false
        end
    end)
    
    return SliderFrame
end

-- Функция создания кнопки
_F.CreateButton = function(name, callback, parentFrame)
    local ButtonFrame = Instance.new("Frame")
    ButtonFrame.Name = name .. "Button"
    ButtonFrame.Size = UDim2.new(1, 0, 0, _F.MOBILE_SETTINGS.BUTTON_HEIGHT)
    ButtonFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
    ButtonFrame.BorderSizePixel = 0
    ButtonFrame.Parent = parentFrame
    
    local ButtonCorner = Instance.new("UICorner")
    ButtonCorner.CornerRadius = UDim.new(0, 6)
    ButtonCorner.Parent = ButtonFrame
    
    local Button = Instance.new("TextButton")
    Button.Name = "Button"
    Button.Size = UDim2.new(1, -10, 1, -6)
    Button.Position = UDim2.new(0, 5, 0, 3)
    Button.BackgroundColor3 = Color3.fromRGB(0, 100, 255)
    Button.BorderSizePixel = 0
    Button.Text = name
    Button.TextColor3 = Color3.fromRGB(255, 255, 255)
    Button.TextSize = _F.MOBILE_SETTINGS.FONT_SIZE
    Button.Font = Enum.Font.GothamBold
    Button.Parent = ButtonFrame
    
    local ButtonCorner2 = Instance.new("UICorner")
    ButtonCorner2.CornerRadius = UDim.new(0, 4)
    ButtonCorner2.Parent = Button
    
    Button.MouseButton1Click:Connect(function()
        callback()
    end)
    
    return Button
end

-- РАБОЧИЕ ФУНКЦИИ

-- ESP функция
_F.ToggleESP = function(enabled)
    _F.ESPEnabled = enabled
    
    if enabled then
        print("ESP: ENABLED")
        -- Создаем ESP для всех игроков
        for _, player in pairs(Players:GetPlayers()) do
            if player ~= LocalPlayer then
                _F.CreatePlayerESP(player)
            end
        end
    else
        print("ESP: DISABLED")
        -- Удаляем все ESP
        for player, folder in pairs(_F.ESPFolders) do
            if folder then
                folder:Destroy()
            end
        end
        _F.ESPFolders = {}
    end
end

_F.CreatePlayerESP = function(player)
    if not _F.ESPEnabled then return end
    
    local character = player.Character
    if not character then return end
    
    local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
    if not humanoidRootPart then return end
    
    -- Создаем ESP folder
    local espFolder = Instance.new("Folder")
    espFolder.Name = player.Name .. "_ESP"
    espFolder.Parent = _F.ScreenGui
    
    -- Highlight
    local highlight = Instance.new("Highlight")
    highlight.Name = "ESPHighlight"
    highlight.Adornee = character
    highlight.FillColor = Color3.fromRGB(255, 0, 0)
    highlight.FillTransparency = 0.7
    highlight.OutlineColor = Color3.fromRGB(255, 0, 0)
    highlight.OutlineTransparency = 0
    highlight.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
    highlight.Parent = espFolder
    
    _F.ESPFolders[player] = espFolder
    
    -- Отслеживаем удаление персонажа
    character.AncestryChanged:Connect(function()
        if not character.Parent then
            if espFolder then
                espFolder:Destroy()
                _F.ESPFolders[player] = nil
            end
        end
    end)
end

-- Walk Speed функция
_F.ToggleWalkSpeed = function(enabled)
    _F.walkSpeedActive = enabled
    
    if enabled then
        local character = LocalPlayer.Character
        if character then
            local humanoid = character:FindFirstChildOfClass("Humanoid")
            if humanoid then
                humanoid.WalkSpeed = _F.walkSpeed
            end
        end
        print("WalkSpeed: ENABLED (" .. _F.walkSpeed .. ")")
    else
        local character = LocalPlayer.Character
        if character then
            local humanoid = character:FindFirstChildOfClass("Humanoid")
            if humanoid then
                humanoid.WalkSpeed = 16
            end
        end
        print("WalkSpeed: DISABLED")
    end
end

_F.UpdateWalkSpeedValue = function(value)
    _F.walkSpeed = value
    if _F.walkSpeedActive then
        _F.ToggleWalkSpeed(true)
    end
    print("WalkSpeed Value: " .. value)
end

-- Jump Power функция
_F.ToggleJumpPower = function(enabled)
    _F.JumpPowerEnabled = enabled
    
    if enabled then
        local character = LocalPlayer.Character
        if character then
            local humanoid = character:FindFirstChildOfClass("Humanoid")
            if humanoid then
                humanoid.JumpPower = _F.JumpPowerValue
            end
        end
        print("JumpPower: ENABLED (" .. _F.JumpPowerValue .. ")")
    else
        local character = LocalPlayer.Character
        if character then
            local humanoid = character:FindFirstChildOfClass("Humanoid")
            if humanoid then
                humanoid.JumpPower = 50
            end
        end
        print("JumpPower: DISABLED")
    end
end

_F.UpdateJumpPowerValue = function(value)
    _F.JumpPowerValue = value
    if _F.JumpPowerEnabled then
        _F.ToggleJumpPower(true)
    end
    print("JumpPower Value: " .. value)
end

-- Fly функция
_F.ToggleFly = function(enabled)
    _F.FlyEnabled = enabled
    
    if enabled then
        _F.StartFly()
        print("Fly: ENABLED")
    else
        _F.StopFly()
        print("Fly: DISABLED")
    end
end

_F.StartFly = function()
    local character = LocalPlayer.Character
    if not character then return end
    
    local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
    local humanoid = character:FindFirstChildOfClass("Humanoid")
    
    if not humanoidRootPart or not humanoid then return end
    
    _F.BodyVelocity = Instance.new("BodyVelocity")
    _F.BodyVelocity.Velocity = Vector3.new(0, 0, 0)
    _F.BodyVelocity.MaxForce = Vector3.new(40000, 40000, 40000)
    _F.BodyVelocity.Parent = humanoidRootPart
    
    _F.BodyGyro = Instance.new("BodyGyro")
    _F.BodyGyro.MaxTorque = Vector3.new(40000, 40000, 40000)
    _F.BodyGyro.P = 1000
    _F.BodyGyro.D = 50
    _F.BodyGyro.Parent = humanoidRootPart
    
    _F.FlyConnection = RunService.Heartbeat:Connect(function()
        if not _F.FlyEnabled or not character then return end
        
        _F.BodyGyro.CFrame = Workspace.CurrentCamera.CFrame
        
        local velocity = Vector3.new(0, 0, 0)
        
        if UserInputService:IsKeyDown(Enum.KeyCode.W) then
            velocity = velocity + (Workspace.CurrentCamera.CFrame.LookVector * _F.FlySpeedValue)
        end
        
        if UserInputService:IsKeyDown(Enum.KeyCode.S) then
            velocity = velocity + (Workspace.CurrentCamera.CFrame.LookVector * -_F.FlySpeedValue)
        end
        
        if UserInputService:IsKeyDown(Enum.KeyCode.A) then
            velocity = velocity + (Workspace.CurrentCamera.CFrame.RightVector * -_F.FlySpeedValue)
        end
        
        if UserInputService:IsKeyDown(Enum.KeyCode.D) then
            velocity = velocity + (Workspace.CurrentCamera.CFrame.RightVector * _F.FlySpeedValue)
        end
        
        if UserInputService:IsKeyDown(Enum.KeyCode.Space) then
            velocity = velocity + Vector3.new(0, _F.FlySpeedValue, 0)
        end
        
        if UserInputService:IsKeyDown(Enum.KeyCode.LeftShift) then
            velocity = velocity + Vector3.new(0, -_F.FlySpeedValue, 0)
        end
        
        _F.BodyVelocity.Velocity = velocity
        humanoid.PlatformStand = true
    end)
end

_F.StopFly = function()
    if _F.FlyConnection then
        _F.FlyConnection:Disconnect()
    end
    
    local character = LocalPlayer.Character
    if character then
        local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
        local humanoid = character:FindFirstChildOfClass("Humanoid")
        
        if humanoid then
            humanoid.PlatformStand = false
        end
        
        if humanoidRootPart then
            if _F.BodyVelocity then
                _F.BodyVelocity:Destroy()
            end
            if _F.BodyGyro then
                _F.BodyGyro:Destroy()
            end
        end
    end
end

-- Noclip функция
_F.ToggleNoclip = function(enabled)
    _F.NoclipEnabled = enabled
    
    if enabled then
        _F.StartNoclip()
        print("Noclip: ENABLED")
    else
        _F.StopNoclip()
        print("Noclip: DISABLED")
    end
end

_F.StartNoclip = function()
    _F.NoclipConnection = RunService.Stepped:Connect(function()
        if not _F.NoclipEnabled then return end
        
        local character = LocalPlayer.Character
        if character then
            for _, part in pairs(character:GetDescendants()) do
                if part:IsA("BasePart") then
                    part.CanCollide = false
                end
            end
        end
    end)
end

_F.StopNoclip = function()
    if _F.NoclipConnection then
        _F.NoclipConnection:Disconnect()
    end
    
    local character = LocalPlayer.Character
    if character then
        for _, part in pairs(character:GetDescendants()) do
            if part:IsA("BasePart") then
                part.CanCollide = true
            end
        end
    end
end

-- God Mode функция
_F.ToggleGodMode = function(enabled)
    _F.GodModeEnabled = enabled
    
    if enabled then
        local character = LocalPlayer.Character
        if character then
            local humanoid = character:FindFirstChildOfClass("Humanoid")
            if humanoid then
                humanoid.MaxHealth = math.huge
                humanoid.Health = math.huge
            end
        end
        print("God Mode: ENABLED")
    else
        local character = LocalPlayer.Character
        if character then
            local humanoid = character:FindFirstChildOfClass("Humanoid")
            if humanoid then
                humanoid.MaxHealth = 100
                humanoid.Health = 100
            end
        end
        print("God Mode: DISABLED")
    end
end

-- No Fog функция
_F.ToggleNoFog = function(enabled)
    _F.NoFogEnabled = enabled
    
    if enabled then
        Lighting.FogEnd = 1000000
        print("No Fog: ENABLED")
    else
        Lighting.FogEnd = 1000
        print("No Fog: DISABLED")
    end
end

-- Time функция
_F.ToggleTime = function(enabled)
    _F.TimeEnabled = enabled
    
    if enabled then
        Lighting.ClockTime = _F.TimeValue
        print("Custom Time: ENABLED (" .. _F.TimeValue .. ")")
    else
        print("Custom Time: DISABLED")
    end
end

_F.UpdateTimeValue = function(value)
    _F.TimeValue = value
    if _F.TimeEnabled then
        Lighting.ClockTime = value
    end
    print("Time Value: " .. value)
end

-- Кнопка закрытия меню
_F.CreateCloseButton = function()
    local CloseButton = Instance.new("TextButton")
    CloseButton.Name = "CloseButton"
    CloseButton.Size = UDim2.new(0, 60, 0, 25)
    CloseButton.Position = UDim2.new(0.5, -30, 1, -30)
    CloseButton.BackgroundColor3 = Color3.fromRGB(200, 60, 60)
    CloseButton.BorderSizePixel = 0
    CloseButton.Text = "CLOSE"
    CloseButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    CloseButton.TextSize = 12
    CloseButton.Font = Enum.Font.GothamBold
    CloseButton.Parent = _F.MainFrame
    
    local CloseCorner = Instance.new("UICorner")
    CloseCorner.CornerRadius = UDim.new(0, 6)
    CloseCorner.Parent = CloseButton
    
    CloseButton.MouseButton1Click:Connect(function()
        _F.ToggleMenu()
    end)
end

-- СОЗДАНИЕ ЭЛЕМЕНТОВ МЕНЮ

-- ESP SETTINGS
_F.CreateToggle("ESP Players", false, _F.ToggleESP, _F.ESPSettingsFrame)
_F.CreateToggle("ESP Generators", false, function(enabled)
    print("Generator ESP: " .. (enabled and "ENABLED" or "DISABLED"))
end, _F.ESPSettingsFrame)
_F.CreateToggle("ESP Pallets", false, function(enabled)
    print("Pallet ESP: " .. (enabled and "ENABLED" or "DISABLED"))
end, _F.ESPSettingsFrame)

-- GAME FEATURES
_F.CreateToggle("Walk Speed", false, _F.ToggleWalkSpeed, _F.GameFeaturesFrame)
_F.CreateSlider("Walk Speed", 16, 100, 16, _F.UpdateWalkSpeedValue, _F.GameFeaturesFrame)
_F.CreateToggle("Jump Power", false, _F.ToggleJumpPower, _F.GameFeaturesFrame)
_F.CreateSlider("Jump Power", 50, 200, 50, _F.UpdateJumpPowerValue, _F.GameFeaturesFrame)
_F.CreateToggle("Fly", false, _F.ToggleFly, _F.GameFeaturesFrame)
_F.CreateSlider("Fly Speed", 10, 100, 50, function(value)
    _F.FlySpeedValue = value
    print("Fly Speed: " .. value)
end, _F.GameFeaturesFrame)
_F.CreateToggle("Noclip", false, _F.ToggleNoclip, _F.GameFeaturesFrame)
_F.CreateToggle("God Mode", false, _F.ToggleGodMode, _F.GameFeaturesFrame)

-- VISUAL SETTINGS
_F.CreateToggle("No Fog", false, _F.ToggleNoFog, _F.VisualSettingsFrame)
_F.CreateToggle("Custom Time", false, _F.ToggleTime, _F.VisualSettingsFrame)
_F.CreateSlider("Time", 0, 24, 12, _F.UpdateTimeValue, _F.VisualSettingsFrame)

-- Кнопка закрытия
_F.CreateCloseButton()

-- Функция переключения меню
_F.ToggleMenu = function()
    _F.MenuOpen = not _F.MenuOpen
    
    local tweenInfo = TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
    
    if _F.MenuOpen then
        local tween = TweenService:Create(_F.MainFrame, tweenInfo, {
            Position = UDim2.new(0.5, -_F.MOBILE_SETTINGS.MENU_WIDTH/2, 0.5, -_F.MOBILE_SETTINGS.MENU_HEIGHT/2)
        })
        tween:Play()
        print("Menu: OPENED")
    else
        local tween = TweenService:Create(_F.MainFrame, tweenInfo, {
            Position = UDim2.new(0.5, -_F.MOBILE_SETTINGS.MENU_WIDTH/2, 1, 50)
        })
        tween:Play()
        print("Menu: CLOSED")
    end
end

-- Управление для мобильных устройств
local lastTapTime = 0
UserInputService.TouchTap:Connect(function(touchPositions, processed)
    if processed then return end
    
    local currentTime = tick()
    
    -- Двойное касание для открытия/закрытия меню
    if currentTime - lastTapTime < 0.5 then
        _F.ToggleMenu()
    end
    
    lastTapTime = currentTime
end)

-- Управление для ПК
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end
    
    if input.KeyCode == Enum.KeyCode.RightShift then
        _F.ToggleMenu()
    end
end)

-- Перетаскивание меню
_F.dragging = false
_F.dragInput = nil
_F.dragStart = nil
_F.startPos = nil

_F.TitleFrame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.Touch then
        _F.dragging = true
        _F.dragStart = input.Position
        _F.startPos = _F.MainFrame.Position
    end
end)

_F.TitleFrame.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.Touch then
        _F.dragInput = input
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if input == _F.dragInput and _F.dragging then
        local delta = input.Position - _F.dragStart
        _F.MainFrame.Position = UDim2.new(
            _F.startPos.X.Scale, 
            _F.startPos.X.Offset + delta.X,
            _F.startPos.Y.Scale, 
            _F.startPos.Y.Offset + delta.Y
        )
    end
end)

UserInputService.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.Touch then
        _F.dragging = false
    end
end)

-- Уведомление
_F.CreateNotification = function()
    local Notification = Instance.new("TextLabel")
    Notification.Name = "MobileHint"
    Notification.Size = UDim2.new(0, 250, 0, 40)
    Notification.Position = UDim2.new(0.5, -125, 0.1, 0)
    Notification.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    Notification.BackgroundTransparency = 0.5
    Notification.Text = "Double Tap or RightShift to Open Menu"
    Notification.TextColor3 = Color3.fromRGB(255, 255, 255)
    Notification.TextSize = 14
    Notification.Font = Enum.Font.GothamBold
    Notification.TextStrokeTransparency = 0
    Notification.ZIndex = 1000
    Notification.Parent = _F.ScreenGui
    
    local Corner = Instance.new("UICorner")
    Corner.CornerRadius = UDim.new(0, 8)
    Corner.Parent = Notification
    
    delay(5, function()
        local tweenOut = TweenService:Create(Notification, TweenInfo.new(0.7, Enum.EasingStyle.Quint, Enum.EasingDirection.In), {
            Position = UDim2.new(0.5, -125, 0, -50)
        })
        tweenOut:Play()
        
        tweenOut.Completed:Connect(function()
            Notification:Destroy()
        end)
    end)
end

-- Автоматическое скрытие меню при старте
_F.MainFrame.Position = UDim2.new(0.5, -_F.MOBILE_SETTINGS.MENU_WIDTH/2, 1, 50)

-- Запуск
delay(1, _F.CreateNotification)

print("Violence District Mobile Menu loaded!")
print("Double tap or press RightShift to open menu")
print("Drag the title to move the menu")

return _F
