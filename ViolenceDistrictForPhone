-- Violence District Mobile Script - FULL VERSION WITH HSV COLOR PICKERS
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local Lighting = game:GetService("Lighting")
local Workspace = game:GetService("Workspace")
local CoreGui = game:GetService("CoreGui")
local LocalPlayer = Players.LocalPlayer

local _F = {}

-- Мобильные настройки
_F.MOBILE_SETTINGS = {
    BUTTON_HEIGHT = 35,
    SLIDER_HEIGHT = 55,
    FONT_SIZE = 12,
    MENU_WIDTH = 320,
    MENU_HEIGHT = 450
}

_F._cache = {}
_F._connections = {}

-- Создание GUI
_F.ScreenGui = Instance.new("ScreenGui")
_F.ScreenGui.Name = "VDMobileMenu"
_F.ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
_F.ScreenGui.ResetOnSpawn = false
_F.ScreenGui.Parent = CoreGui

-- Основной фрейм
_F.MainFrame = Instance.new("Frame")
_F.MainFrame.Name = "MainFrame"
_F.MainFrame.Size = UDim2.new(0, _F.MOBILE_SETTINGS.MENU_WIDTH, 0, _F.MOBILE_SETTINGS.MENU_HEIGHT)
_F.MainFrame.Position = UDim2.new(0.5, -_F.MOBILE_SETTINGS.MENU_WIDTH/2, 0.5, -_F.MOBILE_SETTINGS.MENU_HEIGHT/2)
_F.MainFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 25)
_F.MainFrame.BorderSizePixel = 0
_F.MainFrame.ClipsDescendants = true
_F.MainFrame.Parent = _F.ScreenGui

-- Углы
_F.UICorner = Instance.new("UICorner")
_F.UICorner.CornerRadius = UDim.new(0, 8)
_F.UICorner.Parent = _F.MainFrame

-- Обводка
_F.UIStroke = Instance.new("UIStroke")
_F.UIStroke.Color = Color3.fromRGB(60, 60, 70)
_F.UIStroke.Thickness = 2
_F.UIStroke.Parent = _F.MainFrame

-- Заголовок
_F.TitleFrame = Instance.new("Frame")
_F.TitleFrame.Name = "TitleFrame"
_F.TitleFrame.Size = UDim2.new(1, 0, 0, 35)
_F.TitleFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
_F.TitleFrame.BorderSizePixel = 0
_F.TitleFrame.Parent = _F.MainFrame

_F.TitleCorner = Instance.new("UICorner")
_F.TitleCorner.CornerRadius = UDim.new(0, 8)
_F.TitleCorner.Parent = _F.TitleFrame

_F.TitleLabel = Instance.new("TextLabel")
_F.TitleLabel.Name = "TitleLabel"
_F.TitleLabel.Size = UDim2.new(1, 0, 1, 0)
_F.TitleLabel.BackgroundTransparency = 1
_F.TitleLabel.Text = "VD MOBILE"
_F.TitleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
_F.TitleLabel.TextSize = 14
_F.TitleLabel.Font = Enum.Font.GothamBold
_F.TitleLabel.Parent = _F.TitleFrame

-- Вкладки
_F.TabButtonsFrame = Instance.new("Frame")
_F.TabButtonsFrame.Name = "TabButtonsFrame"
_F.TabButtonsFrame.Size = UDim2.new(1, -20, 0, 30)
_F.TabButtonsFrame.Position = UDim2.new(0, 10, 0, 40)
_F.TabButtonsFrame.BackgroundTransparency = 1
_F.TabButtonsFrame.Parent = _F.MainFrame

_F.TabButtonsLayout = Instance.new("UIListLayout")
_F.TabButtonsLayout.FillDirection = Enum.FillDirection.Horizontal
_F.TabButtonsLayout.Padding = UDim.new(0, 5)
_F.TabButtonsLayout.Parent = _F.TabButtonsFrame

-- Контент
_F.ContentFrame = Instance.new("Frame")
_F.ContentFrame.Name = "ContentFrame"
_F.ContentFrame.Size = UDim2.new(1, -20, 1, -80)
_F.ContentFrame.Position = UDim2.new(0, 10, 0, 75)
_F.ContentFrame.BackgroundTransparency = 1
_F.ContentFrame.Parent = _F.MainFrame

-- Фреймы контента
_F.ESPSettingsFrame = Instance.new("ScrollingFrame")
_F.ESPSettingsFrame.Name = "ESPSettingsFrame"
_F.ESPSettingsFrame.Size = UDim2.new(1, 0, 1, 0)
_F.ESPSettingsFrame.BackgroundTransparency = 1
_F.ESPSettingsFrame.ScrollBarThickness = 4
_F.ESPSettingsFrame.ScrollBarImageColor3 = Color3.fromRGB(80, 80, 90)
_F.ESPSettingsFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
_F.ESPSettingsFrame.AutomaticCanvasSize = Enum.AutomaticSize.Y
_F.ESPSettingsFrame.Visible = true
_F.ESPSettingsFrame.Parent = _F.ContentFrame

_F.ESPColorsFrame = Instance.new("ScrollingFrame")
_F.ESPColorsFrame.Name = "ESPColorsFrame"
_F.ESPColorsFrame.Size = UDim2.new(1, 0, 1, 0)
_F.ESPColorsFrame.BackgroundTransparency = 1
_F.ESPColorsFrame.ScrollBarThickness = 4
_F.ESPColorsFrame.ScrollBarImageColor3 = Color3.fromRGB(80, 80, 90)
_F.ESPColorsFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
_F.ESPColorsFrame.AutomaticCanvasSize = Enum.AutomaticSize.Y
_F.ESPColorsFrame.Visible = false
_F.ESPColorsFrame.Parent = _F.ContentFrame

_F.GameFeaturesFrame = Instance.new("ScrollingFrame")
_F.GameFeaturesFrame.Name = "GameFeaturesFrame"
_F.GameFeaturesFrame.Size = UDim2.new(1, 0, 1, 0)
_F.GameFeaturesFrame.BackgroundTransparency = 1
_F.GameFeaturesFrame.ScrollBarThickness = 4
_F.GameFeaturesFrame.ScrollBarImageColor3 = Color3.fromRGB(80, 80, 90)
_F.GameFeaturesFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
_F.GameFeaturesFrame.AutomaticCanvasSize = Enum.AutomaticSize.Y
_F.GameFeaturesFrame.Visible = false
_F.GameFeaturesFrame.Parent = _F.ContentFrame

_F.VisualSettingsFrame = Instance.new("ScrollingFrame")
_F.VisualSettingsFrame.Name = "VisualSettingsFrame"
_F.VisualSettingsFrame.Size = UDim2.new(1, 0, 1, 0)
_F.VisualSettingsFrame.BackgroundTransparency = 1
_F.VisualSettingsFrame.ScrollBarThickness = 4
_F.VisualSettingsFrame.ScrollBarImageColor3 = Color3.fromRGB(80, 80, 90)
_F.VisualSettingsFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
_F.VisualSettingsFrame.AutomaticCanvasSize = Enum.AutomaticSize.Y
_F.VisualSettingsFrame.Visible = false
_F.VisualSettingsFrame.Parent = _F.ContentFrame

_F.CombatFrame = Instance.new("ScrollingFrame")
_F.CombatFrame.Name = "CombatFrame"
_F.CombatFrame.Size = UDim2.new(1, 0, 1, 0)
_F.CombatFrame.BackgroundTransparency = 1
_F.CombatFrame.ScrollBarThickness = 4
_F.CombatFrame.ScrollBarImageColor3 = Color3.fromRGB(80, 80, 90)
_F.CombatFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
_F.CombatFrame.AutomaticCanvasSize = Enum.AutomaticSize.Y
_F.CombatFrame.Visible = false
_F.CombatFrame.Parent = _F.ContentFrame

-- Layout
_F.ESPLayout = Instance.new("UIListLayout")
_F.ESPLayout.Padding = UDim.new(0, 8)
_F.ESPLayout.Parent = _F.ESPSettingsFrame

_F.ColorsLayout = Instance.new("UIListLayout")
_F.ColorsLayout.Padding = UDim.new(0, 8)
_F.ColorsLayout.Parent = _F.ESPColorsFrame

_F.FeaturesLayout = Instance.new("UIListLayout")
_F.FeaturesLayout.Padding = UDim.new(0, 8)
_F.FeaturesLayout.Parent = _F.GameFeaturesFrame

_F.VisualLayout = Instance.new("UIListLayout")
_F.VisualLayout.Padding = UDim.new(0, 8)
_F.VisualLayout.Parent = _F.VisualSettingsFrame

_F.CombatLayout = Instance.new("UIListLayout")
_F.CombatLayout.Padding = UDim.new(0, 8)
_F.CombatLayout.Parent = _F.CombatFrame

-- Переменные состояния
_F.MenuOpen = true
_F.ESPEnabled = false
_F.GeneratorESPEnabled = false
_F.PalletESPEnabled = false

-- Цвета ESP
_F.SurvivorColor = Color3.fromRGB(0, 255, 0)
_F.KillerColor = Color3.fromRGB(255, 0, 0)
_F.GeneratorColor = Color3.fromRGB(0, 100, 255)
_F.PalletColor = Color3.fromRGB(255, 255, 0)

_F.walkSpeedActive = false
_F.walkSpeed = 16
_F.JumpPowerEnabled = false
_F.JumpPowerValue = 50
_F.FlyEnabled = false
_F.FlySpeedValue = 50
_F.NoclipEnabled = false
_F.GodModeEnabled = false
_F.InvisibleEnabled = false
_F.AntiStunEnabled = false
_F.AntiGrabEnabled = false
_F.MaxEscapeChanceEnabled = false
_F.GrabKillerEnabled = false
_F.RapidFireEnabled = false
_F.DisableTwistAnimationsEnabled = false
_F.NoFogEnabled = false
_F.TimeEnabled = false
_F.TimeValue = 12
_F.MapColorEnabled = false
_F.MapColor = Color3.fromRGB(255, 255, 255)
_F.AimbotEnabled = false
_F.AimbotFOV = 50
_F.AimbotSmoothness = 10
_F.TriggerbotEnabled = false
_F.SilentAimEnabled = false
_F.ThirdPersonEnabled = false
_F.RotatePersonEnabled = false
_F.RotateSpeed = 100

-- ESP переменные
_F.ESPFolders = {}
_F.ESPConnections = {}
_F.GeneratorESPItems = {}
_F.PalletESPItems = {}

-- Функция создания кнопки вкладки
_F.CreateTabButton = function(name, targetFrame)
    local TabButton = Instance.new("TextButton")
    TabButton.Name = name .. "Tab"
    TabButton.Size = UDim2.new(0.2, -4, 1, 0)
    TabButton.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
    TabButton.BorderSizePixel = 0
    TabButton.Text = name
    TabButton.TextColor3 = Color3.fromRGB(200, 200, 200)
    TabButton.TextSize = 10
    TabButton.Font = Enum.Font.GothamBold
    TabButton.Parent = _F.TabButtonsFrame
    
    local TabCorner = Instance.new("UICorner")
    TabCorner.CornerRadius = UDim.new(0, 6)
    TabCorner.Parent = TabButton
    
    TabButton.MouseButton1Click:Connect(function()
        _F.ESPSettingsFrame.Visible = false
        _F.ESPColorsFrame.Visible = false
        _F.GameFeaturesFrame.Visible = false
        _F.VisualSettingsFrame.Visible = false
        _F.CombatFrame.Visible = false
        
        targetFrame.Visible = true
        
        for _, child in ipairs(_F.TabButtonsFrame:GetChildren()) do
            if child:IsA("TextButton") then
                child.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
                child.TextColor3 = Color3.fromRGB(200, 200, 200)
            end
        end
        
        TabButton.BackgroundColor3 = Color3.fromRGB(0, 100, 255)
        TabButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    end)
    
    return TabButton
end

-- Создание вкладок
_F.ESPTab = _F.CreateTabButton("ESP", _F.ESPSettingsFrame)
_F.ColorsTab = _F.CreateTabButton("COLORS", _F.ESPColorsFrame)
_F.FeaturesTab = _F.CreateTabButton("FEATURES", _F.GameFeaturesFrame)
_F.VisualTab = _F.CreateTabButton("VISUAL", _F.VisualSettingsFrame)
_F.CombatTab = _F.CreateTabButton("COMBAT", _F.CombatFrame)

-- Активируем первую вкладку
_F.ESPTab.BackgroundColor3 = Color3.fromRGB(0, 100, 255)
_F.ESPTab.TextColor3 = Color3.fromRGB(255, 255, 255)

-- Функция создания переключателя
_F.CreateToggle = function(name, defaultValue, callback, parentFrame)
    local ToggleFrame = Instance.new("Frame")
    ToggleFrame.Name = name .. "Toggle"
    ToggleFrame.Size = UDim2.new(1, 0, 0, _F.MOBILE_SETTINGS.BUTTON_HEIGHT)
    ToggleFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
    ToggleFrame.BorderSizePixel = 0
    ToggleFrame.Parent = parentFrame
    
    local ToggleCorner = Instance.new("UICorner")
    ToggleCorner.CornerRadius = UDim.new(0, 6)
    ToggleCorner.Parent = ToggleFrame
    
    local ToggleLabel = Instance.new("TextLabel")
    ToggleLabel.Name = "ToggleLabel"
    ToggleLabel.Size = UDim2.new(0.7, 0, 1, 0)
    ToggleLabel.Position = UDim2.new(0, 10, 0, 0)
    ToggleLabel.BackgroundTransparency = 1
    ToggleLabel.Text = name
    ToggleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    ToggleLabel.TextSize = _F.MOBILE_SETTINGS.FONT_SIZE
    ToggleLabel.Font = Enum.Font.Gotham
    ToggleLabel.TextXAlignment = Enum.TextXAlignment.Left
    ToggleLabel.Parent = ToggleFrame
    
    local ToggleButton = Instance.new("TextButton")
    ToggleButton.Name = "ToggleButton"
    ToggleButton.Size = UDim2.new(0, 45, 0, 22)
    ToggleButton.Position = UDim2.new(1, -50, 0.5, -11)
    ToggleButton.BackgroundColor3 = defaultValue and Color3.fromRGB(0, 200, 0) or Color3.fromRGB(80, 80, 90)
    ToggleButton.BorderSizePixel = 0
    ToggleButton.Text = ""
    ToggleButton.Parent = ToggleFrame
    
    local ToggleCorner2 = Instance.new("UICorner")
    ToggleCorner2.CornerRadius = UDim.new(0, 11)
    ToggleCorner2.Parent = ToggleButton
    
    local ToggleDot = Instance.new("Frame")
    ToggleDot.Name = "ToggleDot"
    ToggleDot.Size = UDim2.new(0, 18, 0, 18)
    ToggleDot.Position = UDim2.new(0, defaultValue and 25 or 2, 0, 2)
    ToggleDot.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    ToggleDot.BorderSizePixel = 0
    ToggleDot.Parent = ToggleButton
    
    local ToggleCorner3 = Instance.new("UICorner")
    ToggleCorner3.CornerRadius = UDim.new(0, 9)
    ToggleCorner3.Parent = ToggleDot
    
    ToggleButton.MouseButton1Click:Connect(function()
        defaultValue = not defaultValue
        ToggleButton.BackgroundColor3 = defaultValue and Color3.fromRGB(0, 200, 0) or Color3.fromRGB(80, 80, 90)
        
        local tweenInfo = TweenInfo.new(0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
        local tween = TweenService:Create(ToggleDot, tweenInfo, {
            Position = UDim2.new(0, defaultValue and 25 or 2, 0, 2)
        })
        tween:Play()
        
        callback(defaultValue)
    end)
    
    return ToggleFrame
end

-- Функция создания слайдера
_F.CreateSlider = function(name, minValue, maxValue, defaultValue, callback, parentFrame)
    local SliderFrame = Instance.new("Frame")
    SliderFrame.Name = name .. "Slider"
    SliderFrame.Size = UDim2.new(1, 0, 0, _F.MOBILE_SETTINGS.SLIDER_HEIGHT)
    SliderFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
    SliderFrame.BorderSizePixel = 0
    SliderFrame.Parent = parentFrame
    
    local SliderCorner = Instance.new("UICorner")
    SliderCorner.CornerRadius = UDim.new(0, 6)
    SliderCorner.Parent = SliderFrame
    
    local SliderLabel = Instance.new("TextLabel")
    SliderLabel.Name = "SliderLabel"
    SliderLabel.Size = UDim2.new(1, -20, 0, 20)
    SliderLabel.Position = UDim2.new(0, 10, 0, 5)
    SliderLabel.BackgroundTransparency = 1
    SliderLabel.Text = name .. ": " .. defaultValue
    SliderLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    SliderLabel.TextSize = _F.MOBILE_SETTINGS.FONT_SIZE
    SliderLabel.Font = Enum.Font.Gotham
    SliderLabel.TextXAlignment = Enum.TextXAlignment.Left
    SliderLabel.Parent = SliderFrame
    
    local SliderTrack = Instance.new("Frame")
    SliderTrack.Name = "SliderTrack"
    SliderTrack.Size = UDim2.new(1, -20, 0, 6)
    SliderTrack.Position = UDim2.new(0, 10, 0, 30)
    SliderTrack.BackgroundColor3 = Color3.fromRGB(60, 60, 70)
    SliderTrack.BorderSizePixel = 0
    SliderTrack.Parent = SliderFrame
    
    local SliderTrackCorner = Instance.new("UICorner")
    SliderTrackCorner.CornerRadius = UDim.new(0, 3)
    SliderTrackCorner.Parent = SliderTrack
    
    local SliderFill = Instance.new("Frame")
    SliderFill.Name = "SliderFill"
    SliderFill.Size = UDim2.new((defaultValue - minValue) / (maxValue - minValue), 0, 1, 0)
    SliderFill.BackgroundColor3 = Color3.fromRGB(0, 150, 255)
    SliderFill.BorderSizePixel = 0
    SliderFill.Parent = SliderTrack
    
    local SliderFillCorner = Instance.new("UICorner")
    SliderFillCorner.CornerRadius = UDim.new(0, 3)
    SliderFillCorner.Parent = SliderFill
    
    local SliderButton = Instance.new("TextButton")
    SliderButton.Name = "SliderButton"
    SliderButton.Size = UDim2.new(0, 18, 0, 18)
    SliderButton.Position = UDim2.new((defaultValue - minValue) / (maxValue - minValue), -9, 0.5, -9)
    SliderButton.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    SliderButton.BorderSizePixel = 0
    SliderButton.Text = ""
    SliderButton.ZIndex = 2
    SliderButton.Parent = SliderTrack
    
    local SliderButtonCorner = Instance.new("UICorner")
    SliderButtonCorner.CornerRadius = UDim.new(0, 9)
    SliderButtonCorner.Parent = SliderButton
    
    local dragging = false
    
    local function updateSlider(input)
        if not dragging then return end
        
        local relativeX = math.clamp((input.Position.X - SliderTrack.AbsolutePosition.X) / SliderTrack.AbsoluteSize.X, 0, 1)
        local value = math.floor(minValue + (maxValue - minValue) * relativeX)
        
        SliderFill.Size = UDim2.new(relativeX, 0, 1, 0)
        SliderButton.Position = UDim2.new(relativeX, -9, 0.5, -9)
        SliderLabel.Text = name .. ": " .. value
        
        callback(value)
    end
    
    SliderButton.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.Touch or input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
        end
    end)
    
    SliderTrack.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.Touch or input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            updateSlider(input)
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if dragging and (input.UserInputType == Enum.UserInputType.Touch or input.UserInputType == Enum.UserInputType.MouseMovement) then
            updateSlider(input)
        end
    end)
    
    UserInputService.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.Touch or input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = false
        end
    end)
    
    return SliderFrame
end

-- Функция создания кнопки
_F.CreateButton = function(name, callback, parentFrame)
    local ButtonFrame = Instance.new("Frame")
    ButtonFrame.Name = name .. "Button"
    ButtonFrame.Size = UDim2.new(1, 0, 0, _F.MOBILE_SETTINGS.BUTTON_HEIGHT)
    ButtonFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
    ButtonFrame.BorderSizePixel = 0
    ButtonFrame.Parent = parentFrame
    
    local ButtonCorner = Instance.new("UICorner")
    ButtonCorner.CornerRadius = UDim.new(0, 6)
    ButtonCorner.Parent = ButtonFrame
    
    local Button = Instance.new("TextButton")
    Button.Name = "Button"
    Button.Size = UDim2.new(1, -10, 1, -6)
    Button.Position = UDim2.new(0, 5, 0, 3)
    Button.BackgroundColor3 = Color3.fromRGB(0, 100, 255)
    Button.BorderSizePixel = 0
    Button.Text = name
    Button.TextColor3 = Color3.fromRGB(255, 255, 255)
    Button.TextSize = _F.MOBILE_SETTINGS.FONT_SIZE
    Button.Font = Enum.Font.GothamBold
    Button.Parent = ButtonFrame
    
    local ButtonCorner2 = Instance.new("UICorner")
    ButtonCorner2.CornerRadius = UDim.new(0, 4)
    ButtonCorner2.Parent = Button
    
    Button.MouseButton1Click:Connect(function()
        callback()
    end)
    
    return Button
end

-- HSV to RGB conversion
_F.HSVToRGB = function(h, s, v)
    h = h % 1
    local i = math.floor(h * 6)
    local f = h * 6 - i
    local p = v * (1 - s)
    local q = v * (1 - f * s)
    local t = v * (1 - (1 - f) * s)
    
    if i == 0 then
        return Color3.new(v, t, p)
    elseif i == 1 then
        return Color3.new(q, v, p)
    elseif i == 2 then
        return Color3.new(p, v, t)
    elseif i == 3 then
        return Color3.new(p, q, v)
    elseif i == 4 then
        return Color3.new(t, p, v)
    else
        return Color3.new(v, p, q)
    end
end

-- RGB to HSV conversion
_F.RGBToHSV = function(color)
    local r, g, b = color.R, color.G, color.B
    local max = math.max(r, g, b)
    local min = math.min(r, g, b)
    local h, s, v
    
    v = max
    
    local d = max - min
    if max == 0 then
        s = 0
    else
        s = d / max
    end
    
    if max == min then
        h = 0
    else
        if max == r then
            h = (g - b) / d
            if g < b then
                h = h + 6
            end
        elseif max == g then
            h = (b - r) / d + 2
        elseif max == b then
            h = (r - g) / d + 4
        end
        h = h / 6
    end
    
    return h, s, v
end

-- Функция создания HSV цветового пикера для мобильных устройств
_F.CreateHSVColorPicker = function(name, defaultColor, callback, parentFrame)
    local currentColor = defaultColor
    local currentH, currentS, currentV = _F.RGBToHSV(defaultColor)
    
    local ColorFrame = Instance.new("Frame")
    ColorFrame.Name = name .. "Color"
    ColorFrame.Size = UDim2.new(1, 0, 0, _F.MOBILE_SETTINGS.BUTTON_HEIGHT)
    ColorFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
    ColorFrame.BorderSizePixel = 0
    ColorFrame.Parent = parentFrame
    
    local ColorCorner = Instance.new("UICorner")
    ColorCorner.CornerRadius = UDim.new(0, 6)
    ColorCorner.Parent = ColorFrame
    
    local ColorLabel = Instance.new("TextLabel")
    ColorLabel.Name = "ColorLabel"
    ColorLabel.Size = UDim2.new(0.6, 0, 1, 0)
    ColorLabel.Position = UDim2.new(0, 10, 0, 0)
    ColorLabel.BackgroundTransparency = 1
    ColorLabel.Text = name
    ColorLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    ColorLabel.TextSize = _F.MOBILE_SETTINGS.FONT_SIZE
    ColorLabel.Font = Enum.Font.Gotham
    ColorLabel.TextXAlignment = Enum.TextXAlignment.Left
    ColorLabel.Parent = ColorFrame
    
    local ColorButton = Instance.new("TextButton")
    ColorButton.Name = "ColorButton"
    ColorButton.Size = UDim2.new(0, 50, 0, 25)
    ColorButton.Position = UDim2.new(1, -60, 0.5, -12.5)
    ColorButton.BackgroundColor3 = defaultColor
    ColorButton.BorderSizePixel = 0
    ColorButton.Text = "Pick"
    ColorButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    ColorButton.TextSize = 10
    ColorButton.Font = Enum.Font.GothamBold
    ColorButton.Parent = ColorFrame
    
    local ColorCorner2 = Instance.new("UICorner")
    ColorCorner2.CornerRadius = UDim.new(0, 6)
    ColorCorner2.Parent = ColorButton
    
    -- Создание цветового пикера
    local ColorPickerFrame = Instance.new("Frame")
    ColorPickerFrame.Name = name .. "ColorPicker"
    ColorPickerFrame.Size = UDim2.new(0, 280, 0, 180)
    ColorPickerFrame.Position = UDim2.new(0.5, -140, 0.5, -90)
    ColorPickerFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
    ColorPickerFrame.BorderSizePixel = 0
    ColorPickerFrame.Visible = false
    ColorPickerFrame.ZIndex = 100
    ColorPickerFrame.Parent = _F.ScreenGui
    
    local ColorPickerCorner = Instance.new("UICorner")
    ColorPickerCorner.CornerRadius = UDim.new(0, 8)
    ColorPickerCorner.Parent = ColorPickerFrame
    
    local ColorPickerStroke = Instance.new("UIStroke")
    ColorPickerStroke.Color = Color3.fromRGB(80, 80, 90)
    ColorPickerStroke.Thickness = 2
    ColorPickerStroke.Parent = ColorPickerFrame
    
    -- Палитра оттенков (Hue)
    local HuePicker = Instance.new("Frame")
    HuePicker.Name = "HuePicker"
    HuePicker.Size = UDim2.new(0, 240, 0, 15)
    HuePicker.Position = UDim2.new(0, 20, 0, 20)
    HuePicker.BackgroundColor3 = Color3.new(1, 1, 1)
    HuePicker.BorderSizePixel = 0
    HuePicker.Parent = ColorPickerFrame
    
    local HueGradient = Instance.new("UIGradient")
    HueGradient.Color = ColorSequence.new({
        ColorSequenceKeypoint.new(0, Color3.fromRGB(255, 0, 0)),
        ColorSequenceKeypoint.new(0.17, Color3.fromRGB(255, 255, 0)),
        ColorSequenceKeypoint.new(0.33, Color3.fromRGB(0, 255, 0)),
        ColorSequenceKeypoint.new(0.5, Color3.fromRGB(0, 255, 255)),
        ColorSequenceKeypoint.new(0.67, Color3.fromRGB(0, 0, 255)),
        ColorSequenceKeypoint.new(0.83, Color3.fromRGB(255, 0, 255)),
        ColorSequenceKeypoint.new(1, Color3.fromRGB(255, 0, 0))
    })
    HueGradient.Parent = HuePicker
    
    local HueCorner = Instance.new("UICorner")
    HueCorner.CornerRadius = UDim.new(0, 4)
    HueCorner.Parent = HuePicker
    
    -- Ползунок Hue
    local HueSlider = Instance.new("Frame")
    HueSlider.Name = "HueSlider"
    HueSlider.Size = UDim2.new(0, 4, 0, 19)
    HueSlider.Position = UDim2.new(currentH, -2, 0, 18)
    HueSlider.BackgroundColor3 = Color3.new(1, 1, 1)
    HueSlider.BorderSizePixel = 0
    HueSlider.ZIndex = 101
    HueSlider.Parent = ColorPickerFrame
    
    local HueSliderCorner = Instance.new("UICorner")
    HueSliderCorner.CornerRadius = UDim.new(0, 2)
    HueSliderCorner.Parent = HueSlider
    
    -- Палитра насыщенности и яркости
    local SVPicker = Instance.new("Frame")
    SVPicker.Name = "SVPicker"
    SVPicker.Size = UDim2.new(0, 120, 0, 120)
    SVPicker.Position = UDim2.new(0, 20, 0, 45)
    SVPicker.BackgroundColor3 = _F.HSVToRGB(currentH, 1, 1)
    SVPicker.BorderSizePixel = 0
    SVPicker.Parent = ColorPickerFrame
    
    local SVGradient1 = Instance.new("UIGradient")
    SVGradient1.Rotation = 90
    SVGradient1.Color = ColorSequence.new({
        ColorSequenceKeypoint.new(0, Color3.new(1, 1, 1)),
        ColorSequenceKeypoint.new(1, Color3.new(1, 1, 1))
    })
    SVGradient1.Transparency = NumberSequence.new({
        NumberSequenceKeypoint.new(0, 0),
        NumberSequenceKeypoint.new(1, 1)
    })
    SVGradient1.Parent = SVPicker
    
    local SVGradient2 = Instance.new("UIGradient")
    SVGradient2.Color = ColorSequence.new({
        ColorSequenceKeypoint.new(0, Color3.new(0, 0, 0)),
        ColorSequenceKeypoint.new(1, Color3.new(0, 0, 0))
    })
    SVGradient2.Transparency = NumberSequence.new({
        NumberSequenceKeypoint.new(0, 1),
        NumberSequenceKeypoint.new(1, 0)
    })
    SVGradient2.Parent = SVPicker
    
    local SVCorner = Instance.new("UICorner")
    SVCorner.CornerRadius = UDim.new(0, 4)
    SVCorner.Parent = SVPicker
    
    -- Ползунок SV
    local SVSlider = Instance.new("Frame")
    SVSlider.Name = "SVSlider"
    SVSlider.Size = UDim2.new(0, 6, 0, 6)
    SVSlider.Position = UDim2.new(currentS, -3, 1 - currentV, -3)
    SVSlider.BackgroundColor3 = Color3.new(1, 1, 1)
    SVSlider.BorderSizePixel = 0
    SVSlider.ZIndex = 101
    SVSlider.Parent = SVPicker
    
    local SVStroke = Instance.new("UIStroke")
    SVStroke.Color = Color3.new(0, 0, 0)
    SVStroke.Thickness = 1
    SVStroke.Parent = SVSlider
    
    local SVCorner2 = Instance.new("UICorner")
    SVCorner2.CornerRadius = UDim.new(0, 3)
    SVCorner2.Parent = SVSlider
    
    -- Предпросмотр цвета
    local PreviewFrame = Instance.new("Frame")
    PreviewFrame.Name = "PreviewFrame"
    PreviewFrame.Size = UDim2.new(0, 40, 0, 40)
    PreviewFrame.Position = UDim2.new(0, 160, 0, 45)
    PreviewFrame.BackgroundColor3 = currentColor
    PreviewFrame.BorderSizePixel = 0
    PreviewFrame.Parent = ColorPickerFrame
    
    local PreviewCorner = Instance.new("UICorner")
    PreviewCorner.CornerRadius = UDim.new(0, 6)
    PreviewCorner.Parent = PreviewFrame
    
    local PreviewStroke = Instance.new("UIStroke")
    PreviewStroke.Color = Color3.fromRGB(100, 100, 100)
    PreviewStroke.Thickness = 2
    PreviewStroke.Parent = PreviewFrame
    
    -- Кнопка применения
    local ApplyButton = Instance.new("TextButton")
    ApplyButton.Name = "ApplyButton"
    ApplyButton.Size = UDim2.new(0, 80, 0, 25)
    ApplyButton.Position = UDim2.new(0, 160, 0, 95)
    ApplyButton.BackgroundColor3 = Color3.fromRGB(0, 150, 255)
    ApplyButton.BorderSizePixel = 0
    ApplyButton.Text = "APPLY"
    ApplyButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    ApplyButton.TextSize = 12
    ApplyButton.Font = Enum.Font.GothamBold
    ApplyButton.Parent = ColorPickerFrame
    
    local ApplyCorner = Instance.new("UICorner")
    ApplyCorner.CornerRadius = UDim.new(0, 6)
    ApplyCorner.Parent = ApplyButton
    
    -- Функции обновления
    local function UpdateColor()
        currentColor = _F.HSVToRGB(currentH, currentS, currentV)
        PreviewFrame.BackgroundColor3 = currentColor
        SVPicker.BackgroundColor3 = _F.HSVToRGB(currentH, 1, 1)
    end
    
    local function UpdateHueSlider(position)
        local relativeX = math.clamp((position.X - HuePicker.AbsolutePosition.X) / HuePicker.AbsoluteSize.X, 0, 1)
        currentH = relativeX
        HueSlider.Position = UDim2.new(relativeX, -2, 0, 18)
        UpdateColor()
    end
    
    local function UpdateSVSlider(position)
        local relativeX = math.clamp((position.X - SVPicker.AbsolutePosition.X) / SVPicker.AbsoluteSize.X, 0, 1)
        local relativeY = math.clamp((position.Y - SVPicker.AbsolutePosition.Y) / SVPicker.AbsoluteSize.Y, 0, 1)
        currentS = relativeX
        currentV = 1 - relativeY
        SVSlider.Position = UDim2.new(relativeX, -3, 1 - currentV, -3)
        UpdateColor()
    end
    
    -- Обработчики событий
    local hueDragging = false
    local svDragging = false
    
    HuePicker.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.Touch or input.UserInputType == Enum.UserInputType.MouseButton1 then
            hueDragging = true
            UpdateHueSlider(input.Position)
        end
    end)
    
    SVPicker.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.Touch or input.UserInputType == Enum.UserInputType.MouseButton1 then
            svDragging = true
            UpdateSVSlider(input.Position)
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.Touch or input.UserInputType == Enum.UserInputType.MouseMovement then
            if hueDragging then
                UpdateHueSlider(input.Position)
            elseif svDragging then
                UpdateSVSlider(input.Position)
            end
        end
    end)
    
    UserInputService.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.Touch or input.UserInputType == Enum.UserInputType.MouseButton1 then
            hueDragging = false
            svDragging = false
        end
    end)
    
    -- Кнопка применения
    ApplyButton.MouseButton1Click:Connect(function()
        callback(currentColor)
        ColorButton.BackgroundColor3 = currentColor
        ColorPickerFrame.Visible = false
    end)
    
    -- Закрытие при клике вне пикера
    local function closePicker(input)
        if input.UserInputType == Enum.UserInputType.Touch or input.UserInputType == Enum.UserInputType.MouseButton1 then
            if ColorPickerFrame.Visible then
                local mousePos = input.Position
                local pickerPos = ColorPickerFrame.AbsolutePosition
                local pickerSize = ColorPickerFrame.AbsoluteSize
                
                if mousePos.X < pickerPos.X or mousePos.X > pickerPos.X + pickerSize.X or
                   mousePos.Y < pickerPos.Y or mousePos.Y > pickerPos.Y + pickerSize.Y then
                    ColorPickerFrame.Visible = false
                end
            end
        end
    end
    
    UserInputService.InputBegan:Connect(closePicker)
    
    -- Открытие пикера
    ColorButton.MouseButton1Click:Connect(function()
        ColorPickerFrame.Visible = not ColorPickerFrame.Visible
    end)
    
    return ColorFrame
end

-- РАБОЧИЕ ФУНКЦИИ ESP

-- ESP функция
_F.ToggleESP = function(enabled)
    _F.ESPEnabled = enabled
    
    if enabled then
        print("ESP Players: ENABLED")
        for _, player in pairs(Players:GetPlayers()) do
            if player ~= LocalPlayer then
                _F.CreatePlayerESP(player)
            end
        end
    else
        print("ESP Players: DISABLED")
        for player, folder in pairs(_F.ESPFolders) do
            if folder then
                folder:Destroy()
            end
        end
        _F.ESPFolders = {}
    end
end

_F.CreatePlayerESP = function(player)
    if not _F.ESPEnabled then return end
    
    local character = player.Character
    if not character then return end
    
    local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
    if not humanoidRootPart then return end
    
    local espFolder = Instance.new("Folder")
    espFolder.Name = player.Name .. "_ESP"
    espFolder.Parent = _F.ScreenGui
    
    -- Определяем цвет в зависимости от роли
    local isKiller = _F.IsPlayerKiller(player)
    local espColor = isKiller and _F.KillerColor or _F.SurvivorColor
    
    local highlight = Instance.new("Highlight")
    highlight.Name = "ESPHighlight"
    highlight.Adornee = character
    highlight.FillColor = espColor
    highlight.FillTransparency = 0.7
    highlight.OutlineColor = espColor
    highlight.OutlineTransparency = 0
    highlight.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
    highlight.Parent = espFolder
    
    _F.ESPFolders[player] = espFolder
    
    character.AncestryChanged:Connect(function()
        if not character.Parent then
            if espFolder then
                espFolder:Destroy()
                _F.ESPFolders[player] = nil
            end
        end
    end)
end

-- Функция определения роли игрока
_F.IsPlayerKiller = function(player)
    if player.Team then
        local teamName = string.lower(player.Team.Name)
        return teamName == "killer" or teamName == "murderer"
    end
    return false
end

-- Обновление цветов ESP
_F.UpdateESPColors = function()
    for player, folder in pairs(_F.ESPFolders) do
        if folder then
            local highlight = folder:FindFirstChild("ESPHighlight")
            if highlight then
                local isKiller = _F.IsPlayerKiller(player)
                local espColor = isKiller and _F.KillerColor or _F.SurvivorColor
                highlight.FillColor = espColor
                highlight.OutlineColor = espColor
            end
        end
    end
    
    for generator, folder in pairs(_F.GeneratorESPItems) do
        if folder then
            local highlight = folder:FindFirstChild("GeneratorHighlight")
            if highlight then
                highlight.FillColor = _F.GeneratorColor
                highlight.OutlineColor = _F.GeneratorColor
            end
        end
    end
    
    for pallet, folder in pairs(_F.PalletESPItems) do
        if folder then
            local highlight = folder:FindFirstChild("PalletHighlight")
            if highlight then
                highlight.FillColor = _F.PalletColor
                highlight.OutlineColor = _F.PalletColor
            end
        end
    end
end

-- Generator ESP
_F.ToggleGeneratorESP = function(enabled)
    _F.GeneratorESPEnabled = enabled
    
    if enabled then
        print("Generator ESP: ENABLED")
        _F.FindAndCreateGenerators()
    else
        print("Generator ESP: DISABLED")
        for generator, folder in pairs(_F.GeneratorESPItems) do
            if folder then
                folder:Destroy()
            end
        end
        _F.GeneratorESPItems = {}
    end
end

_F.FindAndCreateGenerators = function()
    for _, obj in pairs(Workspace:GetDescendants()) do
        if string.lower(obj.Name) == "generator" and (obj:IsA("Model") or obj:IsA("Part")) then
            _F.CreateGeneratorESP(obj)
        end
    end
end

_F.CreateGeneratorESP = function(generator)
    local espFolder = Instance.new("Folder")
    espFolder.Name = "Generator_ESP"
    espFolder.Parent = _F.ScreenGui
    
    local highlight = Instance.new("Highlight")
    highlight.Name = "GeneratorHighlight"
    highlight.Adornee = generator
    highlight.FillColor = _F.GeneratorColor
    highlight.FillTransparency = 0.5
    highlight.OutlineColor = _F.GeneratorColor
    highlight.OutlineTransparency = 0
    highlight.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
    highlight.Parent = espFolder
    
    _F.GeneratorESPItems[generator] = espFolder
end

-- Pallet ESP
_F.TogglePalletESP = function(enabled)
    _F.PalletESPEnabled = enabled
    
    if enabled then
        print("Pallet ESP: ENABLED")
        _F.FindAndCreatePallets()
    else
        print("Pallet ESP: DISABLED")
        for pallet, folder in pairs(_F.PalletESPItems) do
            if folder then
                folder:Destroy()
            end
        end
        _F.PalletESPItems = {}
    end
end

_F.FindAndCreatePallets = function()
    for _, obj in pairs(Workspace:GetDescendants()) do
        if string.lower(obj.Name) == "pallet" and (obj:IsA("Model") or obj:IsA("Part")) then
            _F.CreatePalletESP(obj)
        end
    end
end

_F.CreatePalletESP = function(pallet)
    local espFolder = Instance.new("Folder")
    espFolder.Name = "Pallet_ESP"
    espFolder.Parent = _F.ScreenGui
    
    local highlight = Instance.new("Highlight")
    highlight.Name = "PalletHighlight"
    highlight.Adornee = pallet
    highlight.FillColor = _F.PalletColor
    highlight.FillTransparency = 0.5
    highlight.OutlineColor = _F.PalletColor
    highlight.OutlineTransparency = 0
    highlight.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
    highlight.Parent = espFolder
    
    _F.PalletESPItems[pallet] = espFolder
end

-- [ОСТАЛЬНЫЕ ФУНКЦИИ ОСТАЮТСЯ ТАКИМИ ЖЕ КАК В ПРЕДЫДУЩЕЙ ВЕРСИИ]
-- Walk Speed, Jump Power, Fly, Noclip, God Mode, Invisible, AntiStun, AntiGrab, 
-- Max Escape Chance, Grab Killer, Rapid Fire, Disable Twist Animations, No Fog, 
-- Time, Map Color, Aimbot, Triggerbot, Silent Aim, Third Person, Rotate Person

-- СОЗДАНИЕ ЭЛЕМЕНТОВ МЕНЮ

-- ESP SETTINGS
_F.CreateToggle("ESP Players", false, _F.ToggleESP, _F.ESPSettingsFrame)
_F.CreateToggle("ESP Generators", false, _F.ToggleGeneratorESP, _F.ESPSettingsFrame)
_F.CreateToggle("ESP Pallets", false, _F.TogglePalletESP, _F.ESPSettingsFrame)

-- ESP COLORS
_F.CreateHSVColorPicker("Survivor Color", _F.SurvivorColor, function(color)
    _F.SurvivorColor = color
    _F.UpdateESPColors()
    print("Survivor Color updated")
end, _F.ESPColorsFrame)

_F.CreateHSVColorPicker("Killer Color", _F.KillerColor, function(color)
    _F.KillerColor = color
    _F.UpdateESPColors()
    print("Killer Color updated")
end, _F.ESPColorsFrame)

_F.CreateHSVColorPicker("Generator Color", _F.GeneratorColor, function(color)
    _F.GeneratorColor = color
    _F.UpdateESPColors()
    print("Generator Color updated")
end, _F.ESPColorsFrame)

_F.CreateHSVColorPicker("Pallet Color", _F.PalletColor, function(color)
    _F.PalletColor = color
    _F.UpdateESPColors()
    print("Pallet Color updated")
end, _F.ESPColorsFrame)

-- [ОСТАЛЬНЫЕ ЭЛЕМЕНТЫ МЕНЮ ОСТАЮТСЯ ТАКИМИ ЖЕ]
-- GAME FEATURES, COMBAT, VISUAL SETTINGS

-- Кнопка закрытия меню
_F.CreateCloseButton = function()
    local CloseButton = Instance.new("TextButton")
    CloseButton.Name = "CloseButton"
    CloseButton.Size = UDim2.new(0, 60, 0, 25)
    CloseButton.Position = UDim2.new(0.5, -30, 1, -30)
    CloseButton.BackgroundColor3 = Color3.fromRGB(200, 60, 60)
    CloseButton.BorderSizePixel = 0
    CloseButton.Text = "CLOSE"
    CloseButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    CloseButton.TextSize = 12
    CloseButton.Font = Enum.Font.GothamBold
    CloseButton.Parent = _F.MainFrame
    
    local CloseCorner = Instance.new("UICorner")
    CloseCorner.CornerRadius = UDim.new(0, 6)
    CloseCorner.Parent = CloseButton
    
    CloseButton.MouseButton1Click:Connect(function()
        _F.ToggleMenu()
    end)
end

_F.CreateCloseButton()

-- Функция переключения меню
_F.ToggleMenu = function()
    _F.MenuOpen = not _F.MenuOpen
    
    local tweenInfo = TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
    
    if _F.MenuOpen then
        local tween = TweenService:Create(_F.MainFrame, tweenInfo, {
            Position = UDim2.new(0.5, -_F.MOBILE_SETTINGS.MENU_WIDTH/2, 0.5, -_F.MOBILE_SETTINGS.MENU_HEIGHT/2)
        })
        tween:Play()
        print("Menu: OPENED")
    else
        local tween = TweenService:Create(_F.MainFrame, tweenInfo, {
            Position = UDim2.new(0.5, -_F.MOBILE_SETTINGS.MENU_WIDTH/2, 1, 50)
        })
        tween:Play()
        print("Menu: CLOSED")
    end
end

-- [ОСТАЛЬНЫЕ ФУНКЦИИ УПРАВЛЕНИЯ ОСТАЮТСЯ ТАКИМИ ЖЕ]
-- Управление для мобильных устройств, перетаскивание меню, уведомление

print("Violence District Mobile Menu with HSV Color Pickers loaded!")
print("Double tap or press RightShift to open menu")
print("Drag the title to move the menu")

return _F
